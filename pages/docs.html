<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>documentation page</title>
  <style>
    * {
        max-width: 100%
        box-sizing: border-box;
    }
    a:link {
      color: cyan;
      text-decoration: None;
    }

    a:visited {
      color: purple;
      text-decoration: None;
    }

    a:hover {
      text-decoration: underline;
    }

    a:active {
      color: red;
    }

    html {
      color: #DBDBDB;
      background-color: #000000;/*#121212;*/
      font-family: Montserrat;
    }

    body {
      max-width: 1820px;
      padding-left: min(10%, 50px);
      padding-right: min(10%, 50px);
      padding-top: min(10%, 50px);
      padding-bottom: min(10%, 50px);
      margin: auto;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @font-face {
        font-family: Montserrat;
        src: url('../montserrat/static/Montserrat-Light.ttf') format('truetype');
        font-weight: normal;
        font-style: normal;
    } 
    @font-face {
        font-family: Montserrat;
        src: url('../montserrat/static/Montserrat-Medium.ttf') format('truetype');
        font-weight: bold;
        font-style: normal;
    } 
    .title {
      font-size: 2.5em;
      color: #FFFFFF;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
      clear: right;
      color: #EBE3C5;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
      clear: right;
    }
    h6 {
      font-weight: normal;
      clear: right;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      width: 100%;
      table-layout: fixed;
      max-width: 400px;
      margin-left: 0;
      text-align: center;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
      text-align: center;
    }
    .left {
      float: left;
      margin: 0 20px 20px 0;
    }

    .right {
      float: right; 
      margin: 0 0 20px 20px;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    .my-div {
        padding: 20px;
    }
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
    <p><div class="title" style="text-align:center;"><strong>Photoreal Glare Documentation</strong></div></p>
    <div style="text-align:center;">
        <img src="documentation images/addon banner fade.png" style="width:1200px;"/>
    </div>

<h1><strong>Installation</strong></h1>
<h2><strong>Prerequisites</strong></h2>
<h3><strong>Windows</strong></h2>
<p>For AMD GPU (Experimental) install <a href="https://rocmdocs.amd.com/en/latest/deploy/windows/quick_start.html">ROCM</a>.</p>
<p>For NVIDIA GPU install <a href="https://developer.nvidia.com/cuda-downloads?target_os=Windows&target_arch=x86_64">CUDA</a>.</p>

<h3><strong>Linux</strong></h2>
Installation may vary depending on distribution and package manager.
<p>For AMD GPU (Experimental) install <a href="https://rocmdocs.amd.com/en/latest/deploy/linux/quick_start.html">ROCM</a>.</p>
<p>For NVIDIA GPU install <a href="https://developer.nvidia.com/cuda-downloads?target_os=Linux">CUDA</a>.</p>

<h3><strong>MacOS</strong></h2>
<p>No GPU support, so no prerequisites.</p>

<h2><strong>Addon</strong></h2>
<div class="container">
  <ol>
    <li>Open Blender and go to Preferences > Add-ons</li>
    <li>Click “Install...”</li>
    <li>Select the downloaded add-on .zip file</li>
    <li>Check the box to enable the add-on</li>
    <li>Click the “Install dependencies” button to install the libraries needed for the add-on to run</li>
  </ol>
</div>

<h1><strong>How To Use</strong></h1>

<div style="display:block;width:1200px; max-width: 100%; margin: auto;text-align: center;">
    <img src="documentation images/nishita sky demo no glare.png" style="width: 595px;"/>
    <img src="documentation images/nishita sky demo with glare.png" style="width: 595px;"/>
    <div style="text-align: center;"> <small><em>Demo image modified from scene <a href="https://cloud.blender.org/p/gallery/5f4d1791cc1d7c5e0e8832d4">Nishita Sky Demo</a> under <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a> by Blender Studio</em></small> </div>
</div>

<div class="container">
    <img src="documentation images/addon full.png" class="right" style="width: 150px"/>
    <p>
    <strong>Warning: first GPU run may be very slow.</strong>
    <br>
    <br>
    The addon is located in the “Image Editor” window. Select the image you want to apply the glare to, and the easiest way to get started is to click “Render and Apply Glare Preview” This will generate a low quality preview of glare applied to the currently selected image in the image editor. The preview is useful for checking the general size and shape of the glare, though colors and details may be inaccurate, especially for small objects.</p>
    <p>If satisfied with how the glare looks, click “Render and Apply Glare” to generate and apply high quality glare. The following is some more detailed steps on how to configure the glare.</p>
    <p><strong>Tip: </strong>Try generating glare, and applying it separately. Generating the glare may not be possible on the GPU due to VRAM requirements, so generate it on the CPU, and apply it on the GPU.</p>
</div>
<p>
It is recommended to work with images, with a view transform applied, such as Filmic. So if importing images in formats such as OpenEXR do the following:
<ol>
    <li>In the Image Editor, open the EXR file.</li>
    <li>In the Properties panel, set the View as Render option to display the image with the same view transform as when rendering.</li>
</ol>
You can also save the image with the color transform applied, while viewing the image go to “Image” > “Save As”, and make sure to check “Save As Render”.
</p>

<h1>Glare Settings</h1>
<p><img src="documentation images/addon render glare.png" class="right" style="width: 150px"/>
Features settings for the glare, with the most notable ones being aperture type, camera settings, and low step preview.</p>
<ul>
    <li><p><strong>Use Current Image Size:</strong> Use the current image’s largest dimension as “Target Image Size”.</p>
        <ul>
        <p><li><strong>Target Image Size:</strong> The maximum dimension of the image that the glare will be applied to. For a 1920x1080 image, this would be 1920. This setting is useful if you plan to render the glare separately.</li></p>
        </ul></li>
<li><strong>Aperture Source:</strong> The aperture can be defined as either a polygon or an image. Using a polygon allows you to specify the number of edges (a circle is 2 edges). Using an image allows you to specify a custom high-resolution image for the aperture shape. A high resolution image is recommended so the glare effect remains clear and sharp when rendering at any output size. Higher input image resolutions do not impact rendering performance.
<br>
<br>
<table>
<tbody>
    <tr>
    <td><Strong>Image</Strong></td>
    <td><Strong>Polygon</Strong></td>
    </tr>
    <tr>
        <td>
            <div style="text-align:center;">
                <img src="documentation images/addon aperture image.png" style="width:auto">
            </div>
        </td>
    <td>
    <div style="text-align:center;">
		<img src="documentation images/addon aperture polygon.png" style="width:auto">
    </div>
    </td>
    </tr>
</tbody>
</table>
<p style="clear:right;">Here are some example polygon shapes, and their diffraction patterns.</p>

<div style="width: 600px; display: flex; margin:auto;">
    <table style="">
        <tbody>
            <tr>
            <td></td>
            <td><Strong>Aperture Shape</Strong></td>
            <td><Strong>Glare Shape</Strong></td>
            </tr>

            <tr>
                <td><Strong>Circle</Strong></td> 
            <td><img src="documentation images/shape 2.png" style="width:100px;"></td>
            <td><img src="documentation images/cropped 2 edge shape diffraction.png" style="width:100px;"></td>
            </tr>

            <tr>
                <td><Strong>Triangle</Strong></td>
            <td><img src="documentation images/shape 3.png" style="width:100px;"></td>
            <td><img src="documentation images/cropped 3 edge shape diffraction.png" style="width:100px;"></td>
            </tr>

            <tr>
                <td><Strong>Square</Strong></td>
            <td><img src="documentation images/shape 4.png" style="width:100px;"></td>
            <td><img src="documentation images/cropped 4 edge shape diffraction.png" style="width:100px;"></td>
            </tr>

            <tr>
                <td><Strong>Pentagon</Strong></td>
            <td><img src="documentation images/shape 5.png" style="width:100px;"></td>
            <td><img src="documentation images/cropped 5 edge shape diffraction.png" style="width:100px;"></td> 
            </tr>
        </tbody>
    </table>

    <table>
        <tbody>  
            <tr>
            <td></td>
            <td><Strong>Aperture Shape</Strong></td>
            <td><Strong>Glare Shape</Strong></td>
            </tr>

            <tr>
                <td><Strong>Hexagon</Strong></td>
            <td><img src="documentation images/shape 6.png" style="width:100px;"></td>
            <td><img src="documentation images/cropped 6 edge shape diffraction.png" style="width:100px;"></td>
            </tr>

            <tr>
                <td><Strong>Septagon</Strong></td>
            <td><img src="documentation images/shape 7.png" style="width:100px;"></td>
            <td><img src="documentation images/cropped 7 edge shape diffraction.png" style="width:100px;"></td>  
            </tr>

            <tr>
                <td><Strong>Octagon</Strong></td>
            <td><img src="documentation images/shape 8.png" style="width:100px;"></td>
            <td><img src="documentation images/cropped 8 edge shape diffraction.png" style="width:100px;"></td>
            </tr>

            <tr>
                <td><Strong>Nonagon</Strong></td>
            <td><img src="documentation images/shape 9.png" style="width:100px;"></td>
            <td><img src="documentation images/cropped 9 edge shape diffraction.png" style="width:100px;"></td>
            </tr>
        </tbody>
    </table>
</div>

<p>The images shown are for illustration only (Using a tiny aperture size of 0.1 mm, and cropped). In reality, the visible parts of the glare images used are very small, with just one bright pixel at the center, such as this cropped image of the glare from a circular aperture (target: 1024, cropped to 256): <img src="documentation images/cropped 2 edge shape diffraction real example.png" style="width: 200px; display: block; margin: auto;"/></p>

<br>
By using a custom aperture image, we can simulate interesting optical effects like those seen in the classic single slit experiment:
<div style="width: 400px; max-width: 100%; display: flex; margin: auto; padding 10px; justify-content: center; align-items: center;">
  <p>
    <img src="documentation images/cropped single slit.png" style="width: 195px;">
    <img src="documentation images/cropped single slit diffraction.png" style="width: 195px;">
  </p>
</div>
</li>
</ul>

<li><strong>Obstruction image:</strong> used to add imperfections to aperture, like dirt and eyelashes. For example, using a hexagonal aperture:
<ul>
</li>

<div style="text-align:center;">
    <p>
    <img src="documentation images/dirt.png" style="width: 200px;"/>
    </p>
    <small><em>Dirt image</em></small>
    <p>
        <img src="documentation images/glare no obstruction.png" style="width: 200px;image-rendering: pixelated;"/>
        <img src="documentation images/glare with obstruction.png" style="width: 200px;image-rendering: pixelated;"/>
    </p>
    <small><em>Left no obstruction, Right obstruction applied</em></small>
</div>
</ul>

<ul>
<li><strong>Glare Size Method:</strong> Glare size source, use “Camera” for matching size for specific camera settings, and “Value” to use a single easy to tweak value</li>
</ul>

<ul>
<li><p><img src="documentation images/addon camera settings.png" class="right" style="width: 150px"/><strong>Camera:</strong> If a camera is specified, the “Sensor Size”, “Aperture Size”, and “Focal Length” will be read from that camera's settings. If no camera is given, these parameters can be set manually in millimeters. Specifying a camera is recommended for realistic settings based on real lens models. Manually setting the sensor, aperture, and focal length values allows for creative flexibility.</p></li>
</ul>
<ul>
<li><p><strong>Wavelength Range:</strong> This sets the range of colors/wavelengths to generate glare for. The default range covers the full visible spectrum. You can specify a narrower range to isolate glare for certain colors only.</p></li>
<li><p><strong>Wavelength Steps:</strong> The number of color samples taken from the “Wavelength Range”. Higher values provide more spectral accuracy, which is noticeable with lots of multicolored glare. Lower values can create a “stepped color” pattern in the glare due to fewer color samples. For subtle or monochromatic glare, a lower value works fine.</p></li>
<li><p><strong>Dispersion:</strong> Amount of color spread, lower values give a less colorful, sometimes grayscale glare, higher values give more colorful glare. (Values other than 1.0 are not physically accurate)</p></li>
<li><p><strong>Low Step Preview:</strong> Enabling this previews the glare using fewer “Wavelength Steps”, scaled by the “Step Factor”. This improves render performance but shows an approximation of the final glare effect. Useful for quicker preview renders before final high quality output.</p></li>
<li><strong>Render Glare:</strong> Renders the glare image, and shows it in the image editor.</li>
</ul>
<h1>Apply Glare Settings</h1>
<p><img src="documentation images/addon apply glare.png" class="right" style="width: 150px"/>Applies the glare image to the current image in the editor. Currently single-threaded, to save memory.</p>
<ul>
<li><strong>Glare Image:</strong> The glare image to use. It's recommended to generate this in the “Glare Settings” to ensure consistent resolution with the scene. But other images can be used for creative effects.</li>
</ul>
<ul>
<li><strong>Glare Crop Factor:</strong> Gamma correction for glare image, lower values give smaller glare, higher values give larger glare. (Values other than 1.0 are not physically accurate.)</li>
<li><strong>Glare Crop Factor:</strong> Crops the glare image around the center before applying. Higher values improve performance but reduce the maximum glare streak length. Useful for low contrast scenes that don't need long streaks. (It is easier to use “Resize Factor” in “Glare Settings” instead)</li>
</ul>
<ul>
<li><strong>Low Res Preview:</strong> Applies the glare to a lower resolution version of the image, scaled by the “Scale Factor”. This gives a faster preview of the glare effect before final render.</li>
</ul>
<ul>
<li><strong>Apply Glare:</strong> Applies the “Glare Image” to every pixel on the current image in the image editor.</li>
</ul>
</body>
</html>
